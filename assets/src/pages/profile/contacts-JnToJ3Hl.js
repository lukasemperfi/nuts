import{u,d,i as m,a as E,b as p,l as _}from"../../../footer-kwW1Dzn6.js";import{i as L}from"../../../breadcrumbs-k0QsKmE3.js";import{i as F}from"../../../profile-section-Lnmzs4iE.js";import{J as R,F as O,R as c,a as P,E as y,b as M,c as g}from"../../../rules-BILaquOo.js";import{i as C}from"../../../upload-photo-BjjRfj-U.js";import"../../../breadcrumbs-CCIHsRy6.js";const i={FORM:"#profile-contacts-form",FULL_NAME:"#profile-contacts-full-name",EMAIL:"#profile-contacts-email",PHONE:"#profile-contacts-phone",FILE:"#profile-contacts__avatar-file"},l={[i.FULL_NAME]:[c,M],[i.EMAIL]:[c,y],[i.PHONE]:[c,P],[i.FILE]:[...O]};function S(){const e={errorFieldCssClass:"form-field__input_error",errorLabelCssClass:"form-field__error",focusInvalidField:!0,lockForm:!0,validateBeforeSubmitting:!0,errorFieldStyle:{},errorLabelStyle:{}},t=new R(i.FORM,e);for(const r in l)t.addField(r,l[r]);return t}const U=()=>{S().onSuccess(async e=>{e.preventDefault();const t=document.querySelector(i.FORM),r=new FormData(t),a=Object.fromEntries(r.entries()),s=h(a),o=g({successText:"Данные изменены успешно!"});try{await u.updateProfile(s),o.success(),setTimeout(()=>{window.location.reload()},1e3)}catch(n){console.error("Ошибка при обновлении профиля:",n),o.hide()}}),C()},f=(e,t,r)=>{const a={},s=[];for(const o in e)if(o.startsWith(t)){const n=o.replace(t,"");a[n]=e[o],s.push(o)}return s.forEach(o=>delete e[o]),e[r]=a,a},h=e=>{const t=e.person_type;return t==="fop"&&f(e,"fop_","fop"),t==="legal"&&f(e,"legal_entity_","legal_entity"),e};document.addEventListener("DOMContentLoaded",async()=>{await d(),m({selector:".top-header__lang"}),E(),L(),F(),U(),p(),_(".lazy",{rootMargin:"200px 0px"})});
