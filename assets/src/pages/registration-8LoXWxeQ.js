import{s as A,A as F,r as C,i as f,c as v,a as D,b as P,l as U}from"../../footer-BnmDAafM.js";import{i as I}from"../../breadcrumbs-Bdl_gLzY.js";import{J as M,c as N,r as w,R as _}from"../../rules-8moWvT5A.js";import{c as R,r as L}from"../../index-ni-So6HJ.js";const b=()=>{I(".registration-page-breadcrumbs__container","breadcrumbs_color_muted")};function G(){const e=document.querySelector("[data-upload-photo]");if(!e)return;const r=e.querySelector("[data-upload-input]"),t=e.querySelector("[data-upload-preview]"),n=e.querySelector("[data-upload-text]"),a=e.querySelector("[data-upload-remove]"),s=e.dataset.placeholder;r.addEventListener("change",l=>{const d=l.target.files[0];if(!d)return;const p=new FileReader;p.onload=g=>{t.src=g.target.result,e.classList.add("upload-photo_has-image"),n.textContent="Изменить фото"},p.readAsDataURL(d)}),a.addEventListener("click",l=>{l.preventDefault(),r.value="",t.src=s,n.textContent="Загрузить фото",e.classList.remove("upload-photo_has-image")})}const o={FORM:"#registration-form",FULL_NAME:"#registration-full-name",EMAIL:"#registration-email",PHONE:"#registration-phone",COUNTRY:"#registration-country",REGION:"#registration-region",CITY:"#registration-city",PASSWORD:"#registration-password",CONFIRM_PASSWORD:"#registration-confirm-password",AGREE:"#registration-agree",FILE:"#registration__avatar-file",FOP_COUNTRY:"#registration-fop-country",FOP_REGION:"#registration-fop-region",FOP_CITY:"#registration-fop-city",LEGAL_COUNTRY:"#registration-legal-entity-country",LEGAL_REGION:"#registration-legal-entity-region",LEGAL_CITY:"#registration-legal-entity-city"},c={rule:"required",errorMessage:"Поле обязательно для заполнения"},T={rule:"customRegexp",value:/^[А-ЯЁІЇЄҐа-яёіїєґ]+(?:-[А-ЯЁІЇЄҐа-яёіїєґ]+)?\s+[А-ЯЁІЇЄҐа-яёіїєґ]+(?:-[А-ЯЁІЇЄҐа-яёіїєґ]+)?(?:\s+[А-ЯЁІЇЄҐа-яёіїєґ]+(?:-[А-ЯЁІЇЄҐа-яёіїєґ]+)?)?$/,errorMessage:"Введите корректное ФИО"},q={rule:"email",errorMessage:"Введите корректный email"},Y={rule:"customRegexp",value:/^(?:\+380\d{9}|0\d{9})$/,errorMessage:"Введите корректный номер (+380501234567, 0501234567)"},x={rule:"password",errorMessage:"Минимум восемь символов, одна буква и одна цифра"},V={validator:(e,r)=>{if(r[o.PASSWORD]&&r[o.PASSWORD].elem){const t=r[o.PASSWORD].elem.value;return e===t}return!0},errorMessage:"Пароли должны быть одинаковыми"},W={...c,errorMessage:"Подтвердите согласие"},k=[{rule:"files",value:{files:{extensions:["jpeg","jpg","png"],types:["image/jpeg","image/jpg","image/png"]}},errorMessage:"Неверный формат (JPG, PNG)"},{rule:"files",value:{files:{maxSize:2e6}},errorMessage:"Макс 2MB"}],S={[o.FULL_NAME]:[c,T],[o.EMAIL]:[c,q],[o.PHONE]:[c,Y],[o.COUNTRY]:[c],[o.REGION]:[c],[o.CITY]:[c],[o.PASSWORD]:[c,x],[o.CONFIRM_PASSWORD]:[c,V],[o.AGREE]:[W],[o.FILE]:[...k]};function B(){const e={errorFieldCssClass:"form-field__input_error",errorLabelCssClass:"form-field__error",focusInvalidField:!0,lockForm:!0,validateBeforeSubmitting:!0,errorFieldStyle:{},errorLabelStyle:{}},r=new M(o.FORM,e);for(const t in S)r.addField(t,S[t]);return r}const h=(e,r,t)=>{const n={},a=[];for(const s in e)if(s.startsWith(r)){const l=s.replace(r,"");n[l]=e[s],a.push(s)}return a.forEach(s=>delete e[s]),e[t]=n,n},H=e=>{const r=e.person_type;return r==="fop"&&h(e,"fop_","fop"),r==="legal"&&h(e,"legal_entity_","legal_entity"),e};let j="/nuts/";const z=()=>{const e=B().onSuccess(async a=>{a.preventDefault();const s=document.querySelector(o.FORM),l=new FormData(s),d=Object.fromEntries(l.entries()),p=H(d),g=N({successText:"Регистрация прошла успешно!"});A.subscribe("auth",async i=>{i.status===F.LOADING&&g.show(),i.status===F.SUCCEEDED&&(g.success(),w(j,2e3))}),await C(p)});G();const r=f({selector:".registration-form__region-dropdown",disabled:!0});f({selector:".registration-form__country-dropdown",items:R,onChange:(a,s)=>{y(s,r,L)}});const t=f({selector:".registration-form__fop-region-dropdown",disabled:!0});f({selector:".registration-form__fop-country-dropdown",items:R,onChange:(a,s)=>{y(s,t,L)}});const n=f({selector:".registration-form__legal-entity-region-dropdown",disabled:!0});f({selector:".registration-form__legal-entity-country-dropdown",items:R,onChange:(a,s)=>{y(s,n,L)}}),J(e)};function J(e){const r=document.querySelectorAll('input[name="person_type"]'),t=document.querySelector(".fop-entity"),n=document.querySelector(".legal-entity"),a=(i,E)=>{if(!i)return;i.querySelectorAll("input, select, textarea").forEach(m=>{m.disabled=E})},s=i=>{if(!i)return;i.querySelectorAll(".dropdown_select").forEach(u=>{const m=u.querySelector(".dropdown__selected"),O=u.querySelector('.dropdown__option[aria-selected="true"]');m.innerHTML=m.dataset.placeholder,O&&O.removeAttribute("aria-selected")})},l=i=>{if(!i)return;i.querySelectorAll("input, select, textarea").forEach(u=>{u.type==="checkbox"||u.type==="radio"?u.checked=!1:u.value=""}),s(i)};let d="";const p=i=>{l(t),l(n),d==="fop"&&Q(e),d==="legal"&&X(e),a(t,!0),a(n,!0),t.classList.add("hidden"),n.classList.add("hidden"),i==="fop"&&(t.classList.remove("hidden"),a(t,!1),$(e)),i==="legal"&&(n.classList.remove("hidden"),a(n,!1),K(e)),d=i};r.forEach(i=>{i.addEventListener("change",()=>p(i.value))});const g=document.querySelector('input[name="person_type"]:checked');g&&p(g.value)}function y(e,r,t,n,a){const s=t[e]||[];r.updateOptions(s),s.length>0?r.setDisabled(!1):r.setDisabled(!0)}function $(e){[[o.FOP_COUNTRY,[_]],[o.FOP_REGION,[_]],[o.FOP_CITY,[_]]].forEach(t=>{e.addField(t[0],t[1])})}function Q(e){[o.FOP_COUNTRY,o.FOP_REGION,o.FOP_CITY].forEach(t=>{e.removeField(t)})}function K(e){[[o.LEGAL_COUNTRY,[_]],[o.LEGAL_REGION,[_]],[o.LEGAL_CITY,[_]]].forEach(t=>{e.addField(t[0],t[1])})}function X(e){[o.LEGAL_COUNTRY,o.LEGAL_REGION,o.LEGAL_CITY].forEach(t=>{e.removeField(t)})}document.addEventListener("DOMContentLoaded",async()=>{await v(),f({selector:".top-header__lang"}),D(),b(),P(),z(),U(".lazy",{rootMargin:"200px 0px"})});
