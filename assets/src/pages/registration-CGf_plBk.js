import{i as d,s as y,A as _,r as R,a as L,b as h,l as F}from"../../footer-Dto_QxNq.js";import{i as v}from"../../breadcrumbs-CDZIjPaA.js";import{J as A,c as M,r as O}from"../../redirect-BGt_XRA5.js";const D=()=>{v(".registration-page-breadcrumbs__container","breadcrumbs_color_muted")};function w(){const e=document.querySelector("[data-upload-photo]");if(!e)return;const t=e.querySelector("[data-upload-input]"),o=e.querySelector("[data-upload-preview]"),a=e.querySelector("[data-upload-text]"),l=e.querySelector("[data-upload-remove]"),s=e.dataset.placeholder;t.addEventListener("change",i=>{const p=i.target.files[0];if(!p)return;const r=new FileReader;r.onload=g=>{o.src=g.target.result,e.classList.add("upload-photo_has-image"),a.textContent="Изменить фото"},r.readAsDataURL(p)}),l.addEventListener("click",i=>{i.preventDefault(),t.value="",o.src=s,a.textContent="Загрузить фото",e.classList.remove("upload-photo_has-image")})}const n={FORM:"#registration-form",FULL_NAME:"#registration-full-name",EMAIL:"#registration-email",PHONE:"#registration-phone",PASSWORD:"#registration-password",CONFIRM_PASSWORD:"#registration-confirm-password",AGREE:"#registration-agree",FILE:"#registration__avatar-file"},u={rule:"required",errorMessage:"Поле обязательно для заполнения"},P={rule:"customRegexp",value:/^[А-ЯЁІЇЄҐа-яёіїєґ]+(?:-[А-ЯЁІЇЄҐа-яёіїєґ]+)?\s+[А-ЯЁІЇЄҐа-яёіїєґ]+(?:-[А-ЯЁІЇЄҐа-яёіїєґ]+)?(?:\s+[А-ЯЁІЇЄҐа-яёіїєґ]+(?:-[А-ЯЁІЇЄҐа-яёіїєґ]+)?)?$/,errorMessage:"Введите корректное ФИО"},b={rule:"email",errorMessage:"Введите корректный email"},U={rule:"customRegexp",value:/^(?:\+380\d{9}|0\d{9})$/,errorMessage:"Введите корректный номер (+380501234567, 0501234567)"},q={rule:"password",errorMessage:"Минимум восемь символов, одна буква и одна цифра"},C={validator:(e,t)=>{if(t[n.PASSWORD]&&t[n.PASSWORD].elem){const o=t[n.PASSWORD].elem.value;return e===o}return!0},errorMessage:"Пароли должны быть одинаковыми"},x={...u,errorMessage:"Подтвердите согласие"},I=[{rule:"files",value:{files:{extensions:["jpeg","jpg","png"],types:["image/jpeg","image/jpg","image/png"]}},errorMessage:"Неверный формат (JPG, PNG)"},{rule:"files",value:{files:{maxSize:2e6}},errorMessage:"Макс 2MB"}],E={[n.FULL_NAME]:[u,P],[n.EMAIL]:[u,b],[n.PHONE]:[u,U],[n.PASSWORD]:[u,q],[n.CONFIRM_PASSWORD]:[u,C],[n.AGREE]:[x],[n.FILE]:[...I]};function N(){const e={errorFieldCssClass:"form-field__input_error",errorLabelCssClass:"form-field__error",focusInvalidField:!0,lockForm:!0,validateBeforeSubmitting:!0,errorFieldStyle:{},errorLabelStyle:{}},t=new A(n.FORM,e);for(const o in E)t.addField(o,E[o]);return t}const S=(e,t,o)=>{const a={},l=[];for(const s in e)if(s.startsWith(t)){const i=s.replace(t,"");a[i]=e[s],l.push(s)}return l.forEach(s=>delete e[s]),e[o]=a,a},W=e=>{const t=e.person_type;return t==="fop"&&S(e,"fop_","fop"),t==="legal"&&S(e,"legal_entity_","legal_entity"),e};let k="/nuts/";const G=()=>{w(),d({selector:".registration-form__country-dropdown"}),d({selector:".registration-form__region-dropdown"}),d({selector:".registration-form__fop-country-dropdown"}),d({selector:".registration-form__fop-region-dropdown"}),d({selector:".registration-form__legal-entity-country-dropdown"}),d({selector:".registration-form__legal-entity-region-dropdown"}),T(),N().onSuccess(async e=>{e.preventDefault();const t=document.querySelector(n.FORM),o=new FormData(t),a=Object.fromEntries(o.entries()),l=W(a),s=M("Регистрация прошла успешно!");y.subscribe("auth",async i=>{i.status===_.LOADING&&s.show(),i.status===_.SUCCEEDED&&(s.success(),O(k,2e3))}),await R(l)})};function T(){const e=document.querySelectorAll('input[name="person_type"]'),t=document.querySelector(".fop-entity"),o=document.querySelector(".legal-entity"),a=(r,g)=>{if(!r)return;r.querySelectorAll("input, select, textarea").forEach(f=>{f.disabled=g})},l=r=>{if(!r)return;r.querySelectorAll(".dropdown_select").forEach(c=>{const f=c.querySelector(".dropdown__selected"),m=c.querySelector('.dropdown__option[aria-selected="true"]');f.innerHTML=f.dataset.placeholder,m&&m.removeAttribute("aria-selected")})},s=r=>{if(!r)return;r.querySelectorAll("input, select, textarea").forEach(c=>{c.type==="checkbox"||c.type==="radio"?c.checked=!1:c.value=""}),l(r)},i=r=>{s(t),s(o),a(t,!0),a(o,!0),t.classList.add("hidden"),o.classList.add("hidden"),r==="fop"&&(t.classList.remove("hidden"),a(t,!1)),r==="legal"&&(o.classList.remove("hidden"),a(o,!1))};e.forEach(r=>{r.addEventListener("change",()=>i(r.value))});const p=document.querySelector('input[name="person_type"]:checked');p&&i(p.value)}document.addEventListener("DOMContentLoaded",async()=>{d({selector:".top-header__lang"}),L(),D(),h(),G(),F(".lazy",{rootMargin:"200px 0px"})});
