import{s as C,A as F,r as h,i as d,c as P,a as D,b as I,l as U}from"../../footer-kwW1Dzn6.js";import{i as M}from"../../breadcrumbs-CCIHsRy6.js";import{i as N}from"../../upload-photo-BjjRfj-U.js";import{J as G,c as b,R as g}from"../../rules-BILaquOo.js";import{r as v}from"../../redirect-7MlKBWST.js";import{c as R,r as L}from"../../index-ni-So6HJ.js";const w=()=>{M(".registration-page-breadcrumbs__container","breadcrumbs_color_muted")},t={FORM:"#registration-form",FULL_NAME:"#registration-full-name",EMAIL:"#registration-email",PHONE:"#registration-phone",COUNTRY:"#registration-country",REGION:"#registration-region",CITY:"#registration-city",PASSWORD:"#registration-password",CONFIRM_PASSWORD:"#registration-confirm-password",AGREE:"#registration-agree",FILE:"#registration__avatar-file",FOP_COUNTRY:"#registration-fop-country",FOP_REGION:"#registration-fop-region",FOP_CITY:"#registration-fop-city",LEGAL_COUNTRY:"#registration-legal-entity-country",LEGAL_REGION:"#registration-legal-entity-region",LEGAL_CITY:"#registration-legal-entity-city"},l={rule:"required",errorMessage:"Поле обязательно для заполнения"},T={rule:"customRegexp",value:/^[А-ЯЁІЇЄҐа-яёіїєґ]+(?:-[А-ЯЁІЇЄҐа-яёіїєґ]+)?\s+[А-ЯЁІЇЄҐа-яёіїєґ]+(?:-[А-ЯЁІЇЄҐа-яёіїєґ]+)?(?:\s+[А-ЯЁІЇЄҐа-яёіїєґ]+(?:-[А-ЯЁІЇЄҐа-яёіїєґ]+)?)?$/,errorMessage:"Введите корректное ФИО"},Y={rule:"email",errorMessage:"Введите корректный email"},q={rule:"customRegexp",value:/^(?:\+380\d{9}|0\d{9})$/,errorMessage:"Введите корректный номер (+380501234567, 0501234567)"},x={rule:"password",errorMessage:"Минимум восемь символов, одна буква и одна цифра"},V={validator:(e,o)=>{if(o[t.PASSWORD]&&o[t.PASSWORD].elem){const r=o[t.PASSWORD].elem.value;return e===r}return!0},errorMessage:"Пароли должны быть одинаковыми"},W={...l,errorMessage:"Подтвердите согласие"},k=[{rule:"files",value:{files:{extensions:["jpeg","jpg","png"],types:["image/jpeg","image/jpg","image/png"]}},errorMessage:"Неверный формат (JPG, PNG)"},{rule:"files",value:{files:{maxSize:2e6}},errorMessage:"Макс 2MB"}],S={[t.FULL_NAME]:[l,T],[t.EMAIL]:[l,Y],[t.PHONE]:[l,q],[t.COUNTRY]:[l],[t.REGION]:[l],[t.CITY]:[l],[t.PASSWORD]:[l,x],[t.CONFIRM_PASSWORD]:[l,V],[t.AGREE]:[W],[t.FILE]:[...k]};function B(){const e={errorFieldCssClass:"form-field__input_error",errorLabelCssClass:"form-field__error",focusInvalidField:!0,lockForm:!0,validateBeforeSubmitting:!0,errorFieldStyle:{},errorLabelStyle:{}},o=new G(t.FORM,e);for(const r in S)o.addField(r,S[r]);return o}const A=(e,o,r)=>{const a={},n=[];for(const s in e)if(s.startsWith(o)){const u=s.replace(o,"");a[u]=e[s],n.push(s)}return n.forEach(s=>delete e[s]),e[r]=a,a},H=e=>{const o=e.person_type;return o==="fop"&&A(e,"fop_","fop"),o==="legal"&&A(e,"legal_entity_","legal_entity"),e};let j="/nuts/";const z=()=>{const e=B().onSuccess(async n=>{n.preventDefault();const s=document.querySelector(t.FORM),u=new FormData(s),f=Object.fromEntries(u.entries()),_=H(f),p=b({successText:"Регистрация прошла успешно!"});C.subscribe("auth",async i=>{i.status===F.LOADING&&p.show(),i.status===F.SUCCEEDED&&(p.success(),v(j,2e3))}),await h(_)});N();const o=d({selector:".registration-form__region-dropdown",disabled:!0});d({selector:".registration-form__country-dropdown",items:R,onChange:(n,s)=>{O(s,o,L)}});const r=d({selector:".registration-form__fop-region-dropdown",disabled:!0});d({selector:".registration-form__fop-country-dropdown",items:R,onChange:(n,s)=>{O(s,r,L)}});const a=d({selector:".registration-form__legal-entity-region-dropdown",disabled:!0});d({selector:".registration-form__legal-entity-country-dropdown",items:R,onChange:(n,s)=>{O(s,a,L)}}),J(e)};function J(e){const o=document.querySelectorAll('input[name="person_type"]'),r=document.querySelector(".fop-entity"),a=document.querySelector(".legal-entity"),n=(i,E)=>{if(!i)return;i.querySelectorAll("input, select, textarea").forEach(m=>{m.disabled=E})},s=i=>{if(!i)return;i.querySelectorAll(".dropdown_select").forEach(c=>{const m=c.querySelector(".dropdown__selected"),y=c.querySelector('.dropdown__option[aria-selected="true"]');m.innerHTML=m.dataset.placeholder,y&&y.removeAttribute("aria-selected")})},u=i=>{if(!i)return;i.querySelectorAll("input, select, textarea").forEach(c=>{c.type==="checkbox"||c.type==="radio"?c.checked=!1:c.value=""}),s(i)};let f="";const _=i=>{u(r),u(a),f==="fop"&&Q(e),f==="legal"&&X(e),n(r,!0),n(a,!0),r.classList.add("hidden"),a.classList.add("hidden"),i==="fop"&&(r.classList.remove("hidden"),n(r,!1),$(e)),i==="legal"&&(a.classList.remove("hidden"),n(a,!1),K(e)),f=i};o.forEach(i=>{i.addEventListener("change",()=>_(i.value))});const p=document.querySelector('input[name="person_type"]:checked');p&&_(p.value)}function O(e,o,r,a,n){const s=r[e]||[];o.updateOptions(s),s.length>0?o.setDisabled(!1):o.setDisabled(!0)}function $(e){[[t.FOP_COUNTRY,[g]],[t.FOP_REGION,[g]],[t.FOP_CITY,[g]]].forEach(r=>{e.addField(r[0],r[1])})}function Q(e){[t.FOP_COUNTRY,t.FOP_REGION,t.FOP_CITY].forEach(r=>{e.removeField(r)})}function K(e){[[t.LEGAL_COUNTRY,[g]],[t.LEGAL_REGION,[g]],[t.LEGAL_CITY,[g]]].forEach(r=>{e.addField(r[0],r[1])})}function X(e){[t.LEGAL_COUNTRY,t.LEGAL_REGION,t.LEGAL_CITY].forEach(r=>{e.removeField(r)})}document.addEventListener("DOMContentLoaded",async()=>{await P(),d({selector:".top-header__lang"}),D(),w(),I(),z(),U(".lazy",{rootMargin:"200px 0px"})});
